@model Message

<section class="content-box pad gap-bottom">
	<span id="message@(Model.Id)"></span>
	<!-- TODO - if unread target = this, then <span id="latest"></span> -->

	<aside class="float-right">
		@if (Model.CanReply) {
			<span class="small-button replyButton">
				Reply
			</span>
		}

		@if (Model.CanEdit) {
			<a class="small-button"
			   asp-controller="@nameof(Forum3.Controllers.Messages)"
			   asp-action="@nameof(Forum3.Controllers.Messages.Edit)"
			   asp-route-id="@Model.Id">
				Edit
			</a>
		}

		@if (Model.CanDelete) {
			@if (Model.ParentId == 0) {
				<a class="small-button"
				   asp-controller="@nameof(Forum3.Controllers.Messages)"
				   asp-action="@nameof(Forum3.Controllers.Messages.Delete)"
				   asp-route-id="@Model.Id"
				   onclick="return confirm('Are you sure you want to remove this ENTIRE topic?');">
					Delete
				</a>
			}
			else {
				<a class="small-button"
				   asp-controller="@nameof(Forum3.Controllers.Messages)"
				   asp-action="@nameof(Forum3.Controllers.Messages.Delete)"
				   asp-route-id="@Model.Id"
				   onclick="return confirm('Are you sure you want to remove this reply?');">
					Delete
				</a>
			}
		}
	</aside>

	<header class="message-header note">
		@Model.PostedByName
		<time>
			posted @Model.TimePosted
			@if (Model.TimeEdited != Model.TimePosted) {
				<span>| edited @Model.TimeEdited</span>
			}
		</time>
	</header>

	@if (Model.ReplyId > 0) {
			<blockquote>@Html.Raw(Model.ReplyBody)</blockquote>
	}

	<div class="message-body">@Html.Raw(Model.Body)</div>

	<div class="hidden replyForm">
		<p>Reply:</p>
		@Html.Partial("_MessageForm", Model.ReplyForm)
	</div>

	<p><!-- thoughts here --></p>
</section>